{
    "title": "Customize bubble chat",
    "description": "The text chat system allows users to communicate and socialize with each other.",
    "content": "With TextChatService, you can use bubble chat to display customizable speech chat bubbles above user avatars and NPCs. Bubble chat can make your experience more visually immersive and help users easily identify messages and their speakers in a contextually relevant manner. This feature is especially useful for experiences where users need to focus on the content in the meantime communicating with others in a less obtrusive way.\n\nEnable bubble chat\n\nTo enable bubble chat in your experience:\n\n1. In the Explorer window, select Class.BubbleChatConfiguration under Class.TextChatService.\n\n\n\n2. In the Properties window, check the Class.BubbleChatConfiguration.Enabled checkbox.\n\n\n\nBubble customization\n\nAfter enabling bubble chat, you can customize the appearance and behavior of your chat bubbles to match your experience theme. Use the Properties window of Class.BubbleChatConfiguration for basic changes like text color and spacing, or implement advanced customization for bubble background images and other visual adjustments.\n\nAlternatively, add a Class.LocalScript in Class.StarterPlayerScripts with all your customization settings. This allows the engine to apply your customizations during runtime, overriding the settings in Studio. It's useful for adding special effects to chat bubbles when users trigger certain events or conditions.\n\nBasic customization\n\nThe following table shows common bubble chat customization properties. For a full list of customization properties, see Class.BubbleChatConfiguration.\n\n\n\t\tProperty\n\t\tDescription\n\t\tDefault\n\n\n\n\t\tClass.BubbleChatConfiguration.BackgroundColor3|BackgroundColor3\n\t\tBackground color of bubbles in Datatype.Color3.\n\t\t[250, 250, 250]\n\n\n\t\tClass.BubbleChatConfiguration.FontFace|FontFace\n\t\tDatatype.Font of the bubble text.\n\t\tEnum.Font.BuilderSansMedium|BuilderSansMedium\n\n\n\t\tClass.BubbleChatConfiguration.TextColor3|TextColor3\n\t\tColor of bubble text in Datatype.Color3.\n\t\t[57, 59, 61]\n\n\n\t\tClass.BubbleChatConfiguration.TextSize|TextSize\n\t\tSize of bubble text.\n\t\t16\n\n\n\n\t\tProperty\n\t\tDescription\n\t\tDefault\n\n\n\n\t\tClass.BubbleChatConfiguration.Enabled|Enabled\n\t\tIndicating whether bubble chat is enabled in the experience.\n\t\ttrue (checked)\n\n\n\t\tClass.BubbleChatConfiguration.AdorneeName|AdorneeName\n\t\tString name of the body part or Class.Attachment that bubbles attach to; if multiple instances of the same name exist, the system attaches to the first instance found.\n\t\tHumanoidRootPart\n\n\n\t\tClass.BubbleChatConfiguration.BubbleDuration|BubbleDuration\n\t\tTime before a bubble fades out, in seconds.\n\t\t30\n\n\n\t\tClass.BubbleChatConfiguration.BubblesSpacing|BubblesSpacing\n\t\tVertical space between stacked bubbles, in pixels.\n\t\t6\n\n\n\t\tClass.BubbleChatConfiguration.LocalPlayerStudsOffset|LocalPlayerStudsOffset\n\t\tIf adorned to the local player, the offset of bubbles in studs from their adornee, relative to the camera orientation (Datatype.Vector3).\n\t\t(0, 0, 0)\n\n\n\t\tClass.BubbleChatConfiguration.MaxDistance|MaxDistance\n\t\tMaximum distance from the camera that bubbles are shown.\n\t\t100\n\n\n\t\tClass.BubbleChatConfiguration.MinimizeDistance|MinimizeDistance\n\t\tDistance from the camera when bubbles turn into a single bubble with an ellipsis (&ctdot;) to indicate chatter.\n\t\t40\n\n\n\t\tClass.BubbleChatConfiguration.VerticalStudsOffset|VerticalStudsOffset\n\t\tExtra space between bubbles and their adornee, in studs.\n\t\t0\n\n\n\t\tClass.BubbleChatConfiguration.MaxBubbles|MaxBubbles\n\t\tMaximum number of bubbles displayed before older bubbles disappear.\n\t\t3\n\n\nAdvanced customization\n\nFor advanced customization of your bubble, add UI objects representing certain aspects of the bubble appearance as children under Class.BubbleChatConfiguration, including:\n\n- Class.ImageLabel for background image settings.\n- Class.UIGradient for background gradient settings.\n- Class.UICorner for the corner shape of bubbles.\n- Class.UIPadding for the padding space between the text and bubble edges, relative to the parent's normal size.\n\nAfter adding these objects, you can modify properties of these objects applicable to chat bubbles for advanced bubble customization. The following example Class.LocalScript adds a background image and sharp corners to bubbles:\n\nlua title=\"Advanced Bubble Customization\"\nlocal TextChatService = game:GetService(\"TextChatService\")\n\nlocal bubbleChatConfiguration = TextChatService.BubbleChatConfiguration\nbubbleChatConfiguration.TailVisible = false\nbubbleChatConfiguration.TextColor3 = Color3.fromRGB(220, 50, 50)\nbubbleChatConfiguration.FontFace = Font.fromEnum(Enum.Font.LuckiestGuy)\n\nlocal bubbleUICorner = bubbleChatConfiguration:FindFirstChildOfClass(\"UICorner\")\nif not bubbleUICorner then\n\tbubbleUICorner = Instance.new(\"UICorner\")\n\tbubbleUICorner.Parent = bubbleChatConfiguration\nend\nbubbleUICorner.CornerRadius = UDim.new(0, 0)\n\nlocal bubbleUIPadding = bubbleChatConfiguration:FindFirstChildOfClass(\"UIPadding\")\nif not bubbleUIPadding then\n\tbubbleUIPadding = Instance.new(\"UIPadding\")\n\tbubbleUIPadding.Parent = bubbleChatConfiguration\nend\nbubbleUIPadding.PaddingTop = UDim.new(0, 20)\nbubbleUIPadding.PaddingRight = UDim.new(0, 10)\nbubbleUIPadding.PaddingBottom = UDim.new(0, 15)\nbubbleUIPadding.PaddingLeft = UDim.new(0, 10)\n\nlocal bubbleImageLabel = bubbleChatConfiguration:FindFirstChildOfClass(\"ImageLabel\")\nif not bubbleImageLabel then\n\tbubbleImageLabel = Instance.new(\"ImageLabel\")\n\tbubbleImageLabel.Parent = bubbleChatConfiguration\nend\nbubbleImageLabel.Image = \"rbxassetid://109157529833093\"\nbubbleImageLabel.ScaleType = Enum.ScaleType.Slice\nbubbleImageLabel.SliceCenter = Rect.new(40, 40, 320, 120)\nbubbleImageLabel.SliceScale = 0.5\n\nThe following tables outline the available Class.GuiObject and appearance modifier children along with their valid customization properties:\n\n\n\t\tProperty\n\t\tDescription\n\t\tDefault\n\n\n\n\t\tClass.ImageLabel.Image|Image\n\t\tAsset ID of the bubble background image.\n\n\n\n\t\tClass.ImageLabel.ImageColor3|ImageColor3\n\t\tColor tint of the bubble background image in Datatype.Color3.\n\t\t[255, 255, 255]\n\n\n\t\tClass.ImageLabel.ImageRectOffset|ImageRectOffset\n\t\tOffset of the image area to be displayed from the top-left in pixels.\n\t\t(0, 0)\n\n\n\t\tClass.ImageLabel.ImageRectSize|ImageRectSize\n\t\tSize of the image area to be displayed in pixels. To display the entire image, set either dimension to 0.\n\t\t(0, 0)\n\n\n\t\tClass.ImageLabel.ScaleType|ScaleType\n\t\tThe scale type for rendering the image when its size is different from the absolute size of the bubble.\n\t\tEnum.ScaleType|Stretch\n\n\n\t\tClass.ImageLabel.SliceCenter|SliceCenter\n\t\tSlice boundaries of the image if the image is a 9-sliced image. Only applicable when you set Class.ImageLabel.ScaleType|ScaleType as Enum.ScaleType|Slice.\n\t\t(0, 0, 0, 0)\n\n\n\t\tClass.ImageLabel.SliceScale|SliceScale\n\t\tScale ratio of slice edges if the image is a 9-sliced image. Only applicable when you set Class.ImageLabel.ScaleType|ScaleType as Enum.ScaleType|Slice.\n\t\t1\n\n\n\t\tClass.ImageLabel.TileSize|TileSize\n\t\tTiling size of the image. Only applicable when you set Class.ImageLabel.ScaleType|ScaleType as Enum.ScaleType|Tile.\n\t\t(1, 0, 1, 0)\n\n\n\n\t\tProperty\n\t\tDescription\n\t\tDefault\n\n\n\n\t\tClass.UIGradient.Enabled|Enabled\n\t\tIndicating whether the bubble background gradient is enabled.\n\t\tfalse (unchecked)\n\n\n\t\tClass.UIGradient.Color|Color\n\t\tColor of the background gradient.\n\t\t[250, 250, 250]\n\n\n\t\tClass.UIGradient.Offset|Offset\n\t\tScalar translation of the gradient from the center of the bubble.\n\t\t(0, 0)\n\n\n\t\tClass.UIGradient.Rotation|Rotation\n\t\tClockwise rotation, in degrees, of the gradient starts from left to right.\n\t\t0\n\n\n\t\tClass.UIGradient.Transparency|Transparency\n\t\tTransparency of the background gradient.\n\t\t(1, 0)\n\n\n\n\t\tProperty\n\t\tDescription\n\t\tDefault\n\n\n\n\t\tClass.UICorner.CornerRadius|CornerRadius\n\t\tRadius of the bubble corner shape in pixels.\n\t\t(0, 12)\n\n\n\n\t\tProperty\n\t\tDescription\n\t\tDefault\n\n\n\n\t\tClass.UIPadding.PaddingBottom|PaddingBottom\n\t\tPadding on the bottom.\n\t\tDatatype.UDim.new(0,8)\n\n\n\t\tClass.UIPadding.PaddingLeft|PaddingLeft\n\t\tPadding on the left.\n\t\tDatatype.UDim.new(0,8)\n\n\n\t\tClass.UIPadding.PaddingRight|PaddingRight\n\t\tPadding on the right.\n\t\tDatatype.UDim.new(0,8)\n\n\n\t\tClass.UIPadding.PaddingTop|PaddingTop\n\t\tPadding on the top.\n\t\tDatatype.UDim.new(0,8)\n\n\nPer-bubble customization\n\nYou can individually style and modify chat bubble behaviors based on specific conditions in order to override your general settings. For example, you can use chat bubbles to differentiate NPCs and users, highlight critical health status, and apply special effects to messages with pre-defined keywords.\n\nTo set per-bubble customization, add a client-side Class.LocalScript using Class.BubbleChatMessageProperties, which overrides matching properties of Class.BubbleChatConfiguration, and the Class.TextChatService.OnBubbleAdded callback to specify how to customize each bubble. The callback supplies you with the Class.TextChatMessage property as well as the adornee, so you can apply the customization based on attributes associated with users, the chat text content, user character properties, and any special conditions you want to define.\n\nThe following basic customization properties are available for per-bubble customization:\n\n\n\t\tProperty\n\t\tDescription\n\t\tDefault\n\n\n\n\t\tClass.BubbleChatConfiguration.BackgroundColor3|BackgroundColor3\n\t\tBackground color of bubbles in Datatype.Color3.\n\t\t(250, 250, 250)\n\n\n\t\tClass.BubbleChatConfiguration.BackgroundTransparency|BackgroundTransparency\n\t\tBackground transparency of bubbles.\n\t\t0.1\n\n\n\t\tClass.BubbleChatConfiguration.FontFace|FontFace\n\t\tDatatype.Font of the bubble text.\n\t\tEnum.Font.BuilderSansMedium|BuilderSansMedium\n\n\n\t\tClass.BubbleChatConfiguration.TextColor3|TextColor3\n\t\tColor of bubble text in Datatype.Color3.\n\t\t[57, 59, 61]\n\n\n\t\tClass.BubbleChatConfiguration.TextSize|TextSize\n\t\tSize of bubble text.\n\t\t16\n\n\nThe following example adds special appearance to VIP users' chat bubbles by checking if a chat message sender has the IsVIP attribute:\n\nlua title=\"VIP Bubbles\"\nlocal TextChatService = game:GetService(\"TextChatService\")\nlocal Players = game:GetService(\"Players\")\n\n-- Event handler for when a new chat bubble is added to the experience\nTextChatService.OnBubbleAdded = function(message: TextChatMessage, adornee: Instance)\n\t-- Check if the chat message has a TextSource (sender) associated with it\n\tif message.TextSource then\n\t\t-- Create a new BubbleChatMessageProperties instance to customize the chat bubble\n\t\tlocal bubbleProperties = Instance.new(\"BubbleChatMessageProperties\")\n\n\t\t-- Get the user who sent the chat message based on their UserId\n\t\tlocal player = Players:GetPlayerByUserId(message.TextSource.UserId)\n\n\t\tif player:GetAttribute(\"IsVIP\") then\n\t\t\t-- If the player is a VIP, customize the chat bubble properties\n\t\t\tbubbleProperties.TextColor3 = Color3.fromHex(\"#F5CD30\")\n\t\t\tbubbleProperties.BackgroundColor3 = Color3.fromRGB(25, 27, 29)\n\t\t\tbubbleProperties.FontFace = Font.fromEnum(Enum.Font.PermanentMarker)\n\t\tend\n\t\treturn bubbleProperties\n\tend\nend\n\nAll advanced customization options are available for per-bubble customization. Similar to advanced customization for general bubbles, add instances that you want to customize as children of Class.BubbleChatMessageProperties. The following example adds a special gradient effect along with other properties to chat bubbles of users with low health status by checking the Class.Humanoid.Health property of chat message senders' characters:\n\nlua title=\"Low Health Bubbles\"\nlocal TextChatService = game:GetService(\"TextChatService\")\nlocal Players = game:GetService(\"Players\")\n\n-- Event handler for when a new chat bubble is added to the experience\nTextChatService.OnBubbleAdded = function(message: TextChatMessage, adornee: Instance)\n\t-- Check if the chat message has a TextSource (sender) associated with it\n\tif message.TextSource then\n\t\t-- Get the user who sent the chat message by using their UserId\n\t\tlocal player = Players:GetPlayerByUserId(message.TextSource.UserId)\n\n\t\t-- Find the humanoid in the user's character\n\t\tlocal humanoid = player.Character:FindFirstChildWhichIsA(\"Humanoid\")\n\n\t\tif humanoid and humanoid.Health\n\nManually display bubbles\n\nYou might want to display a chat bubble when players haven't sent a message, such as with NPCs. Use the Class.TextChatService:DisplayBubble method to manually display a chat bubble.\n\nCustomization of these bubbles is the same as the customization of the bubbles that are automatically displayed when Players send messages through TextChannels using the Class.TextChatService.OnBubbleAdded callback.\n\nTo generate speech or other text using an LLM, see the Class.TextGenerator class.\n\nNPC bubbles\n\nDisplay chat bubbles for non-player characters (NPCs) by calling Class.TextChatService:DisplayBubble(character, message), with the NPC character and the message as parameters. These bubbles are customizable using the Class.TextChatService.OnBubbleAdded callback just like any other chat bubble.\n\nClass.TextChatService:DisplayBubble() only works on client-side scripts, so be sure to use a Class.Script with Class.BaseScript.RunContext|RunContext set to Enum.RunContext.Client, or a Class.LocalScript in an appropriate container, such as Class.StarterPlayerScripts. If you attach a Class.ProximityPrompt to an NPC, a script for displaying a chat bubble might look like this:\n\nlua\nlocal TextChatService = game:GetService(\"TextChatService\")\nlocal Workspace = game:GetService(\"Workspace\")\n\nlocal prompt = Workspace.SomeNPC.ProximityPrompt\nlocal head = prompt.Parent:WaitForChild(\"Head\")\n\nprompt.Triggered:Connect(function()\n\tTextChatService:DisplayBubble(head, \"Hello world!\")\nend)",
    "source": "bubble-chat.md"
}