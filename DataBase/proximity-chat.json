{
    "title": "Proximity-based chat",
    "description": "Learn how to implement exclusive chat for users who are close to each other in locations using the TextChatService.",
    "content": "This example shows how to implement an exclusive chat for users who are near each other in the 3D world. It extends the callback with a function using Class.TextSource to identify the locations of a user who might be a potential message receiver. If this function returns false, it means that the user locates further than the preset valid range from the message sender, so the system doesn't deliver the message to that user.\n\nAdd the following to a Class.Script in Class.ServerScriptService:\n\nlua title=\"Server\"\nlocal TextChatService = game:GetService(\"TextChatService\")\nlocal Players = game:GetService(\"Players\")\n\n-- Get the chat channel for proximity-based chat\n-- You can replace this general channel with a dedicated channel\nlocal generalChannel: TextChannel = TextChatService:WaitForChild(\"TextChannels\").RBXGeneral\n\n-- Function to get the position of a user's character\nlocal function getPositionFromUserId(userId: number)\n\t-- Get the player associated with the given user ID\n\tlocal targetPlayer = Players:GetPlayerByUserId(userId)\n\n\t-- If the player exists, get their character's position\n\tif targetPlayer then\n\t\tlocal targetCharacter = targetPlayer.Character\n\t\tif targetCharacter then\n\t\t\treturn targetCharacter:GetPivot().Position\n\t\tend\n\tend\n\n\t-- Return a default position if the player or character cannot be found\n\treturn Vector3.zero\nend\n\n-- Set the callback for the general channel to control message delivery\ngeneralChannel.ShouldDeliverCallback = function(textChatMessage: TextChatMessage, targetTextSource: TextSource)\n\t-- Get the positions of the message sender and target\n\tlocal sourcePos = getPositionFromUserId(textChatMessage.TextSource.UserId)\n\tlocal targetPos = getPositionFromUserId(targetTextSource.UserId)\n\n\t-- Deliver message if distance between sender and target is less than 50 units\n\treturn (targetPos - sourcePos).Magnitude < 50\nend",
    "source": "proximity-chat.md"
}